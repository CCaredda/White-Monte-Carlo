\hypertarget{manual__segmentation_8py}{}\doxysection{/home/caredda/\+DVP/simulation/\+CREATIS-\/\+UCL-\/\+White-\/\+Monte-\/\+Carlo-\/\+Framework/\+WMC\+\_\+simulations/manual\+\_\+segmentation.py File Reference}
\label{manual__segmentation_8py}\index{/home/caredda/DVP/simulation/CREATIS-\/UCL-\/White-\/Monte-\/Carlo-\/Framework/WMC\_simulations/manual\_segmentation.py@{/home/caredda/DVP/simulation/CREATIS-\/UCL-\/White-\/Monte-\/Carlo-\/Framework/WMC\_simulations/manual\_segmentation.py}}


Python script to segment RGB image of brain cortex into six classes\+:  


\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_ab2b802a83691224647489db7b7df34bf}\label{manual__segmentation_8py_ab2b802a83691224647489db7b7df34bf}} 
def {\bfseries manual\+\_\+segmentation.\+Equalize\+Hist} (img, mask)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_af829e5bb67603821516c611c94125fe7}\label{manual__segmentation_8py_af829e5bb67603821516c611c94125fe7}} 
int {\bfseries manual\+\_\+segmentation.\+x1} = 155
\begin{DoxyCompactList}\small\item\em Get image resolution. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{manual__segmentation_8py_a7ea51d2f8518623e58cd78e2ea45672a}\label{manual__segmentation_8py_a7ea51d2f8518623e58cd78e2ea45672a}} 
int {\bfseries manual\+\_\+segmentation.\+y1} = 419
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a49af524a18145b5d6f02ce620adad307}\label{manual__segmentation_8py_a49af524a18145b5d6f02ce620adad307}} 
int {\bfseries manual\+\_\+segmentation.\+x2} = 192
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a74772c09e1770d22dff2a590eac59259}\label{manual__segmentation_8py_a74772c09e1770d22dff2a590eac59259}} 
int {\bfseries manual\+\_\+segmentation.\+y2} = 532
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a71078a414f6f23d3d9110c69bba8b813}\label{manual__segmentation_8py_a71078a414f6f23d3d9110c69bba8b813}} 
np {\bfseries manual\+\_\+segmentation.\+l\+\_\+px} = np.\+sqrt((x1-\/x2)$\ast$$\ast$2 + (y1-\/y2)$\ast$$\ast$2)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a90732403abba674197ff807312246312}\label{manual__segmentation_8py_a90732403abba674197ff807312246312}} 
int {\bfseries manual\+\_\+segmentation.\+reso\+\_\+mm} = 10/l\+\_\+px
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a6865de14e7078ac26fcffaf65065567b}\label{manual__segmentation_8py_a6865de14e7078ac26fcffaf65065567b}} 
bool {\bfseries manual\+\_\+segmentation.\+reduce\+\_\+\+ROI} = False
\begin{DoxyCompactList}\small\item\em Process K-\/\+MEans or thresholding. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{manual__segmentation_8py_a372b5af5bf609dbd37b7f9c8676739ac}\label{manual__segmentation_8py_a372b5af5bf609dbd37b7f9c8676739ac}} 
bool {\bfseries manual\+\_\+segmentation.\+crop\+\_\+img} = False
\item 
\mbox{\Hypertarget{manual__segmentation_8py_aa42e39be955ce42e8a2e58b19605d293}\label{manual__segmentation_8py_aa42e39be955ce42e8a2e58b19605d293}} 
bool {\bfseries manual\+\_\+segmentation.\+use\+\_\+greyscale} = False
\item 
\mbox{\Hypertarget{manual__segmentation_8py_ada72db7cdd1dd752cc5559bd26b73a99}\label{manual__segmentation_8py_ada72db7cdd1dd752cc5559bd26b73a99}} 
bool {\bfseries manual\+\_\+segmentation.\+use\+\_\+\+Kmeans} = False
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a539d075e60b430a9501b82209d71f3b3}\label{manual__segmentation_8py_a539d075e60b430a9501b82209d71f3b3}} 
int {\bfseries manual\+\_\+segmentation.\+block\+\_\+size} = 71
\item 
\mbox{\Hypertarget{manual__segmentation_8py_ac0bbed3594412582fbf0f3c3d1228849}\label{manual__segmentation_8py_ac0bbed3594412582fbf0f3c3d1228849}} 
int {\bfseries manual\+\_\+segmentation.\+size\+\_\+small\+\_\+vessels} = 7
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a642867f314eeca340cef037893910935}\label{manual__segmentation_8py_a642867f314eeca340cef037893910935}} 
int {\bfseries manual\+\_\+segmentation.\+min\+\_\+area} = 100
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a954037e161c0712aff6c522ac68c9ceb}\label{manual__segmentation_8py_a954037e161c0712aff6c522ac68c9ceb}} 
int {\bfseries manual\+\_\+segmentation.\+K} = 10
\item 
\mbox{\Hypertarget{manual__segmentation_8py_af09228f08740f29b6a26f0c7375bfb94}\label{manual__segmentation_8py_af09228f08740f29b6a26f0c7375bfb94}} 
int {\bfseries manual\+\_\+segmentation.\+saturated\+\_\+pixel\+\_\+val} = 170
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a983aa79c0464725422491849f66da9f1}\label{manual__segmentation_8py_a983aa79c0464725422491849f66da9f1}} 
int {\bfseries manual\+\_\+segmentation.\+erode\+\_\+mask\+\_\+size} = 51
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a1ddfbbb8d0a84e04a35bd2dd447757ea}\label{manual__segmentation_8py_a1ddfbbb8d0a84e04a35bd2dd447757ea}} 
str {\bfseries manual\+\_\+segmentation.\+directory\+\_\+path} = \char`\"{}/home/caredda/DVP/simulation/CREATIS-\/UCL-\/White-\/Monte-\/Carlo-\/Framework/WMC\+\_\+simulations/\char`\"{}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_acd576bd2051c4f89e94404ddd6d9a7fa}\label{manual__segmentation_8py_acd576bd2051c4f89e94404ddd6d9a7fa}} 
str {\bfseries manual\+\_\+segmentation.\+path} = directory\+\_\+path+\char`\"{}images/Patient7/\char`\"{}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_acef0b65c3095b8b0064f3ad8958f3dc4}\label{manual__segmentation_8py_acef0b65c3095b8b0064f3ad8958f3dc4}} 
cv {\bfseries manual\+\_\+segmentation.\+img} = cv.\+imread(path+\char`\"{}initial\+\_\+img.\+png\char`\"{})
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a2e526c18e8ee0328b6750f61cbd9d676}\label{manual__segmentation_8py_a2e526c18e8ee0328b6750f61cbd9d676}} 
cv {\bfseries manual\+\_\+segmentation.\+mask} = cv.\+imread(path+\char`\"{}mask.\+png\char`\"{},cv.\+IMREAD\+\_\+\+GRAYSCALE)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a6af1bebe8a87bf1f38e3daaa5f9ee6f1}\label{manual__segmentation_8py_a6af1bebe8a87bf1f38e3daaa5f9ee6f1}} 
cv {\bfseries manual\+\_\+segmentation.\+kernel} = cv.\+get\+Structuring\+Element(cv.\+MORPH\+\_\+\+ELLIPSE,(erode\+\_\+mask\+\_\+size,erode\+\_\+mask\+\_\+size))
\item 
\mbox{\Hypertarget{manual__segmentation_8py_abed5e7055b38da99058db628588b64c1}\label{manual__segmentation_8py_abed5e7055b38da99058db628588b64c1}} 
cv {\bfseries manual\+\_\+segmentation.\+mask\+\_\+act\+\_\+temp} = cv.\+imread(path+\char`\"{}mask\+\_\+activity.\+png\char`\"{})
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a777251874c853331a1dee118bba388f2}\label{manual__segmentation_8py_a777251874c853331a1dee118bba388f2}} 
{\bfseries manual\+\_\+segmentation.\+else} \+:
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a9eef376722345701a2812300918e1a81}\label{manual__segmentation_8py_a9eef376722345701a2812300918e1a81}} 
{\bfseries manual\+\_\+segmentation.\+contours}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a1e39bc8aecc4b62321fbd830065c95c2}\label{manual__segmentation_8py_a1e39bc8aecc4b62321fbd830065c95c2}} 
{\bfseries manual\+\_\+segmentation.\+hierarchy}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a41fd20b4d06eae9aa0d314808d579b40}\label{manual__segmentation_8py_a41fd20b4d06eae9aa0d314808d579b40}} 
{\bfseries manual\+\_\+segmentation.\+x}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a656b7d8c6ab1b92779bda2ac540b927b}\label{manual__segmentation_8py_a656b7d8c6ab1b92779bda2ac540b927b}} 
{\bfseries manual\+\_\+segmentation.\+y}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a113257dabb903e880e3987c43ff7a8de}\label{manual__segmentation_8py_a113257dabb903e880e3987c43ff7a8de}} 
{\bfseries manual\+\_\+segmentation.\+w}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a665d4fd5d24c04dc1bcff1e4810fdb04}\label{manual__segmentation_8py_a665d4fd5d24c04dc1bcff1e4810fdb04}} 
{\bfseries manual\+\_\+segmentation.\+h}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a9cce36c7bacdb5f2c25c4062769e608e}\label{manual__segmentation_8py_a9cce36c7bacdb5f2c25c4062769e608e}} 
int {\bfseries manual\+\_\+segmentation.\+r1} = 138
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a32e113c5de439c4758a190e438d6213d}\label{manual__segmentation_8py_a32e113c5de439c4758a190e438d6213d}} 
cv {\bfseries manual\+\_\+segmentation.\+r2} = mask.\+shape\mbox{[}0\mbox{]}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a4bce6e14061ca819ee6dd3c2602e5166}\label{manual__segmentation_8py_a4bce6e14061ca819ee6dd3c2602e5166}} 
int {\bfseries manual\+\_\+segmentation.\+c1} = 0
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a916fbac5dd1d3a69a51d5a2058cdefbf}\label{manual__segmentation_8py_a916fbac5dd1d3a69a51d5a2058cdefbf}} 
cv {\bfseries manual\+\_\+segmentation.\+c2} = mask.\+shape\mbox{[}1\mbox{]}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a13fb82955d8e43e16d02f1f4c63a8ffd}\label{manual__segmentation_8py_a13fb82955d8e43e16d02f1f4c63a8ffd}} 
cv {\bfseries manual\+\_\+segmentation.\+img\+\_\+proc} = img
\item 
\mbox{\Hypertarget{manual__segmentation_8py_abf484adf8e86f26688269bfd0478bf21}\label{manual__segmentation_8py_abf484adf8e86f26688269bfd0478bf21}} 
cv {\bfseries manual\+\_\+segmentation.\+img\+\_\+\+Grey} = cv.\+cvt\+Color(img\+\_\+proc,cv.\+COLOR\+\_\+\+BGR2\+GRAY)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a3c46b17daebfa095033796ce97303fa3}\label{manual__segmentation_8py_a3c46b17daebfa095033796ce97303fa3}} 
np {\bfseries manual\+\_\+segmentation.\+coord} = np.\+where(mask==255)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_aa687014d2baa590aa685b8dc86b2ca18}\label{manual__segmentation_8py_aa687014d2baa590aa685b8dc86b2ca18}} 
cv {\bfseries manual\+\_\+segmentation.\+Z} = img\+\_\+\+Grey\mbox{[}coord\mbox{]}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a85b009c02c70e83b8ca347ba8370f54a}\label{manual__segmentation_8py_a85b009c02c70e83b8ca347ba8370f54a}} 
np {\bfseries manual\+\_\+segmentation.\+r} = np.\+copy(img\+\_\+proc\mbox{[}\+:,\+:,0\mbox{]})
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a3472a87161e8a86e159ed4e5fef5fc09}\label{manual__segmentation_8py_a3472a87161e8a86e159ed4e5fef5fc09}} 
np {\bfseries manual\+\_\+segmentation.\+g} = np.\+copy(img\+\_\+proc\mbox{[}\+:,\+:,1\mbox{]})
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a3dbfcfee7764554e9e05b19c17a68b56}\label{manual__segmentation_8py_a3dbfcfee7764554e9e05b19c17a68b56}} 
np {\bfseries manual\+\_\+segmentation.\+b} = np.\+copy(img\+\_\+proc\mbox{[}\+:,\+:,2\mbox{]})
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a8538f5639827278f4ccec88fccb3c3fd}\label{manual__segmentation_8py_a8538f5639827278f4ccec88fccb3c3fd}} 
np {\bfseries manual\+\_\+segmentation.\+r\+\_\+pixels} = r\mbox{[}coord\mbox{]}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_aafe9d7628ccea667e1aeda0acac2929a}\label{manual__segmentation_8py_aafe9d7628ccea667e1aeda0acac2929a}} 
np {\bfseries manual\+\_\+segmentation.\+g\+\_\+pixels} = g\mbox{[}coord\mbox{]}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_ae618db5ebdffbcc193d470fe1fa9df87}\label{manual__segmentation_8py_ae618db5ebdffbcc193d470fe1fa9df87}} 
np {\bfseries manual\+\_\+segmentation.\+b\+\_\+pixels} = b\mbox{[}coord\mbox{]}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_acb57af960bcf1d4cd9e45850e69b9b31}\label{manual__segmentation_8py_acb57af960bcf1d4cd9e45850e69b9b31}} 
tuple {\bfseries manual\+\_\+segmentation.\+criteria} = (cv.\+TERM\+\_\+\+CRITERIA\+\_\+\+EPS + cv.\+TERM\+\_\+\+CRITERIA\+\_\+\+MAX\+\_\+\+ITER, 500, 1.\+0)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a26e7f5923a84fa75687004f0e6110539}\label{manual__segmentation_8py_a26e7f5923a84fa75687004f0e6110539}} 
{\bfseries manual\+\_\+segmentation.\+ret}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a7966473f18c48f133267bfbeb4788cdd}\label{manual__segmentation_8py_a7966473f18c48f133267bfbeb4788cdd}} 
{\bfseries manual\+\_\+segmentation.\+label}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_aff952f9f051193dc583d96dd205f4729}\label{manual__segmentation_8py_aff952f9f051193dc583d96dd205f4729}} 
{\bfseries manual\+\_\+segmentation.\+center}
\item 
\mbox{\Hypertarget{manual__segmentation_8py_acab4af60b6a4828b32ecf53ae49f3695}\label{manual__segmentation_8py_acab4af60b6a4828b32ecf53ae49f3695}} 
np {\bfseries manual\+\_\+segmentation.\+output} = np.\+zeros(mask.\+shape)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a742e35522599992f5cf93e983d7384a4}\label{manual__segmentation_8py_a742e35522599992f5cf93e983d7384a4}} 
{\bfseries manual\+\_\+segmentation.\+img\+\_\+sat} = cv.\+morphology\+Ex(img\+\_\+sat, cv.\+MORPH\+\_\+\+CLOSE, kernel)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_ab336f1e8f1cc17cb252e99b5061fc3c9}\label{manual__segmentation_8py_ab336f1e8f1cc17cb252e99b5061fc3c9}} 
cv {\bfseries manual\+\_\+segmentation.\+img\+\_\+thresh} = cv.\+adaptive\+Threshold(img\+\_\+\+Grey,255,cv.\+ADAPTIVE\+\_\+\+THRESH\+\_\+\+GAUSSIAN\+\_\+C,cv.\+THRESH\+\_\+\+BINARY\+\_\+\+INV,block\+\_\+size,0)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_abf088029634dd24d5b723f9fc795b19f}\label{manual__segmentation_8py_abf088029634dd24d5b723f9fc795b19f}} 
cv {\bfseries manual\+\_\+segmentation.\+temp} = cv.\+morphology\+Ex(img\+\_\+thresh, cv.\+MORPH\+\_\+\+OPEN, kernel)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_ac7b6b1879ef3263fe9eb90a758c49849}\label{manual__segmentation_8py_ac7b6b1879ef3263fe9eb90a758c49849}} 
np {\bfseries manual\+\_\+segmentation.\+mask\+\_\+large\+\_\+vessels} = np.\+zeros(temp.\+shape)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a2b24d76d25c74624c7290c6b8e642788}\label{manual__segmentation_8py_a2b24d76d25c74624c7290c6b8e642788}} 
np {\bfseries manual\+\_\+segmentation.\+mask\+\_\+capillaries} = np.\+bitwise\+\_\+xor(img\+\_\+thresh,mask\+\_\+large\+\_\+vessels)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_af2e127d871fb22158ce6cd600910891b}\label{manual__segmentation_8py_af2e127d871fb22158ce6cd600910891b}} 
np {\bfseries manual\+\_\+segmentation.\+mask\+\_\+\+GM} = np.\+bitwise\+\_\+and(np.\+bitwise\+\_\+not(mask\+\_\+large\+\_\+vessels),np.\+bitwise\+\_\+not(mask\+\_\+capillaries))
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a9003334d75a76591c25a68f02a4a66d8}\label{manual__segmentation_8py_a9003334d75a76591c25a68f02a4a66d8}} 
np {\bfseries manual\+\_\+segmentation.\+label\+\_\+\+BV} = np.\+array(\mbox{[}9,3\mbox{]})
\begin{DoxyCompactList}\small\item\em identify label of large blood vessels and capillaries \end{DoxyCompactList}\item 
\mbox{\Hypertarget{manual__segmentation_8py_ae5134f29c9b8c8c7290e4c1402d8257e}\label{manual__segmentation_8py_ae5134f29c9b8c8c7290e4c1402d8257e}} 
np {\bfseries manual\+\_\+segmentation.\+label\+\_\+capillaries} = np.\+array(\mbox{[}2\mbox{]})
\item 
\mbox{\Hypertarget{manual__segmentation_8py_af812b7ba1e07b3593600e8cfb44a8135}\label{manual__segmentation_8py_af812b7ba1e07b3593600e8cfb44a8135}} 
int {\bfseries manual\+\_\+segmentation.\+area\+\_\+min} = 101
\item 
\mbox{\Hypertarget{manual__segmentation_8py_aaaf77531ba1b44cd06d539834abb1bcb}\label{manual__segmentation_8py_aaaf77531ba1b44cd06d539834abb1bcb}} 
np {\bfseries manual\+\_\+segmentation.\+mask\+\_\+activation} = np.\+zeros(mask\+\_\+act\+\_\+temp.\+shape)
\begin{DoxyCompactList}\small\item\em Select functional brain areas. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{manual__segmentation_8py_a5eefa5f9bc65288278f20c8f93ebded0}\label{manual__segmentation_8py_a5eefa5f9bc65288278f20c8f93ebded0}} 
np {\bfseries manual\+\_\+segmentation.\+mask\+\_\+activated\+\_\+grey\+\_\+matter} = np.\+bitwise\+\_\+and(mask\+\_\+activation,mask\+\_\+\+GM)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a3a20e2752a63849d1f3d745d5373ec74}\label{manual__segmentation_8py_a3a20e2752a63849d1f3d745d5373ec74}} 
np {\bfseries manual\+\_\+segmentation.\+mask\+\_\+activated\+\_\+large\+\_\+vessels} = np.\+bitwise\+\_\+and(mask\+\_\+activation,mask\+\_\+large\+\_\+vessels)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_ac9bac13879cae76bf12f294a891599c0}\label{manual__segmentation_8py_ac9bac13879cae76bf12f294a891599c0}} 
np {\bfseries manual\+\_\+segmentation.\+mask\+\_\+activated\+\_\+capillaries} = np.\+bitwise\+\_\+and(mask\+\_\+activation,mask\+\_\+capillaries)
\item 
\mbox{\Hypertarget{manual__segmentation_8py_a4362088c9faf41bac8eba7d79214fe56}\label{manual__segmentation_8py_a4362088c9faf41bac8eba7d79214fe56}} 
np {\bfseries manual\+\_\+segmentation.\+mask\+\_\+output} = np.\+ones(mask.\+shape)
\begin{DoxyCompactList}\small\item\em Write output. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{manual__segmentation_8py_a7f396df4d474e1f2b72803546905d32b}\label{manual__segmentation_8py_a7f396df4d474e1f2b72803546905d32b}} 
int {\bfseries manual\+\_\+segmentation.\+mask\+\_\+output\+\_\+display} = 127$\ast$np.\+ones((mask.\+shape\mbox{[}0\mbox{]},mask.\+shape\mbox{[}1\mbox{]},3))
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Python script to segment RGB image of brain cortex into six classes\+: 


\begin{DoxyItemize}
\item Non activated grey matter
\item Non activated large blood vessels
\item Non activated capillaries
\item Activated grey matter
\item Activated large blood vessels
\item Activated capillaries
\end{DoxyItemize}

\begin{DoxyAuthor}{Author}
Charly Caredda Contact\+: \href{mailto:caredda.c@gmail.com}{\texttt{ caredda.\+c@gmail.\+com}} 
\end{DoxyAuthor}
